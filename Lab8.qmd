---
title: "Lab 8"
webr:  
  show-startup-message: true    # Display status of webR initialization
  packages: ['data.table', 'tidyverse', 'ggplot2', 'survival', 'survmine'] # Pre-install dependency
editor_options: 
  chunk_output_type: console
---

Lab 8 covers 

* **Effect measure modification**

* **Mediation** 

::: {.callout-tip collapse="true"}
### Q1: Is the following statement true?: "Effect modification can be present with no interaction. Interaction can be present with no effect modification."

A: TRUE

See VanderWeele 2009.

Interaction may be used to describe instances in which potential interventions on a secondary exposure are in view (i.e., considers counterfactual outcome intervening on both exposures), while effect modification may be used to describe instances in which merely conditioning on a secondary exposure is in view (i.e., considers counterfactual outcome intervening on one exposure only).

Examples:

-   Effect modification: Gene × Environment interaction (the gene is not modifiable, but the environment may be modifiable)

-   Interaction: Medication × Medication interaction (both medications are modifiable)

The distinction depends on the conceptual framework of your study.

Formulas:

-   Effect modifier: $E[D_{e1}|Q=q_1,X=x]-E[D_{e0}|Q=q_1,X=x] \neq E[D_{e1}|Q=q_0,X=x]-E[D_{e0}|Q=q_0,X=x]$

-   Interaction: $E[D_{e_1,q_1}|X=x]-E[D_{e_0,q_1}|X=x] \neq E[D_{e_1,q_o}|X=x]-E[D_{e_0,q_0}|X=x]$

Where there are 2 levels of E ( $e_0$ and $e_1$ ), and 2 levels of Q ( $q_0$ and $q_1$ )

In other words, when investigating interaction, you need to account for confounders between $E$ and $D$ as well as those between $Q$ and $D$. In contrast, when focusing on effect modification, adjustment for confounders between $E$ and $D$ may be sufficient.

:::

Suppose the table below represents the number of outcomes within each exposure group:

Exposure 2 = Yes

|              | Cases | Controls | Total |
|--------------|-------|----------|-------|
| Exposure 1 + | 20    | 80       | 100   |
| Exposure 1 - | 10    | 90       | 100   |

Exposure 2 = No

|              | Cases | Controls | Total |
|--------------|-------|----------|-------|
| Exposure 1 + | 30    | 70       | 100   |
| Exposure 1 - | 20    | 80       | 100   |

::: {.callout-tip collapse="true"}
### Q2: Is there evidence of additive or multiplicative interaction?

A:

First, calculate the risks across all the combination of exposure 1 and exposure 2.

|              | Exposure 2 + | Exposure 2 - |     |
|--------------|--------------|--------------|-----|
| Exposure 1 + | 0.2          | 0.3          |     |
| Exposure 1 - | 0.1          | 0.2          |     |

Calculate the following outcomes under:

-   First exposure only

-   Second exposure only

-   Both exposures

-   Neither exposure

Using these risks, we can calculate additive and multiplicative interactions.

-   Additive interaction (the extent to which of the two exposures together exceeds the effect of each considered individually **on the additive scale measure**):

$(p_{11}-p_{00})-[(p_{10}-p_{00})+(p_{01}-p_{00})]=p_{11}-p_{10}-p_{01}+p_{00}=0.2-0.3-0.1+0.2=0$

$\rightarrow$ No superadditive or subadditive interactions

$RR_{10}=p_{10}/p_{00}$

$RR_{01}=p_{01}/p_{00}$

$RR_{11}=p_{11}/p_{00}$

-   Multiplicative interaction (the extent to which of the two exposures together exceeds the effect of each considered individually **on the multiplicative scale measure**): $\frac{RR_{11}}{RR_{10} \times RR_{01}}=\frac{p_{11}p_{00}}{p_{10}p_{01}}=\frac{0.2 \times 0.2}{0.1 \times 0.3} \approx 1.33$

$\rightarrow$ Supermultiplicative

:::callout-note
The presence of an additive interaction does not imply the presence of a multiplicative interaction, and vice versa.
:::

:::

* What outcome scale are you referring to?

e.g., A logistic regression model

$logit(Pr(Y=1|X_1,X_2))=\beta_0+\beta_1X_1+\beta_2X_2+\beta_3X_1X_2$

```
glm(outcome ~ exposure1 + exposure2 + exposure1:expsoure2,
family = binomial(link = "logit"), data = data)
```
::: {.callout-tip collapse="true"}
### Q: Does $\beta_3$ represent an additive or multiplicative interaction?

Answer: On the logit scale ( $\beta_3$ ), it is additive, whereas on the odds ratio scale, it is multiplicative.

Interaction or effect measure modification = "Different treatment effects dependent on other variables"

```{r, echo=FALSE, out.width="70%", fig.align = "center"}
knitr::include_graphics("figures/interaction.png")
```

Treatment effects are linear on a log-odds scale, while the probability of the outcomes changes depending on other variables without interaction terms.

The left figure illustrates a logistic regression model **with** an interaction term (on a **logit** scale), whereas the right figure shows a model **without** an interaction term (on a **probability** scale).

$\rightarrow$ Nonlinear regression analyses show an inherent interaction! (An interaction term does not necessarily indicate "interaction")

We should be cautious about the outcome scales.

$\rightarrow$ This is the motivation for the weighting approach (marginal structural model). You can think about the 2×2 table (from the question above) in the pseudo-population!

:::callout-note
Weighting is very cool, as it allows us to simplify complex situations into just 2×2 table questions.
:::

:::

